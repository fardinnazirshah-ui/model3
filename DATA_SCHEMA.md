# Data Schema Documentation

## Overview

This document describes the data sources, file formats, and transformations used in the recession prediction project.

---

## Raw Data Files (`data/raw/`)

### 1. fred_raw_indicators.csv
**Source**: Federal Reserve Economic Data (FRED) API  
**Frequency**: Monthly  
**Coverage**: January 2000 - December 2024  
**Total Rows**: 300

**Columns**:

| Column | FRED Code | Description | Units | Source |
|--------|-----------|-------------|-------|--------|
| date | N/A | Date of observation | YYYY-MM-DD | FRED |
| UNRATE | UNRATE | Unemployment Rate | Percent | Bureau of Labor Statistics |
| PAYEMS | PAYEMS | Nonfarm Payroll Employment | Thousands | Bureau of Labor Statistics |
| CIVPART | CIVPART | Labor Force Participation Rate | Percent | Bureau of Labor Statistics |
| INDPRO | INDPRO | Industrial Production Index | 2017=100 | Federal Reserve |
| HOUST | HOUST | Housing Starts | Thousands | Census Bureau |
| CPIAUCSL | CPIAUCSL | Consumer Price Index (All Items) | 1982-84=100 | Bureau of Labor Statistics |
| CPILFESL | CPILFESL | Consumer Price Index (Core, excluding food & energy) | 1982-84=100 | Bureau of Labor Statistics |
| UMCSENT | UMCSENT | University of Michigan Consumer Sentiment Index | 1966 Q1=100 | University of Michigan |
| ICSA | ICSA | Initial Jobless Claims | Thousands (weekly) | Department of Labor |
| DGS10 | DGS10 | 10-Year Treasury Constant Maturity Rate | Percent | Federal Reserve |
| DGS2 | DGS2 | 2-Year Treasury Constant Maturity Rate | Percent | Federal Reserve |
| DFF | DFF | Federal Funds Effective Rate | Percent | Federal Reserve |
| VIXCLS | VIXCLS | Volatility Index (VIX) | Index (0-100 scale) | Chicago Board Options Exchange |

**Format**:
```csv
date,UNRATE,PAYEMS,CIVPART,INDPRO,HOUST,CPIAUCSL,CPILFESL,UMCSENT,ICSA,DGS10,DGS2,DFF,VIXCLS
2000-01-01,4.0,130500,67.3,85.2,1569,172.0,109.7,112.0,357000,6.15,4.89,5.16,20.5
2000-02-01,4.1,131000,67.4,85.8,1567,172.3,109.8,111.5,348000,6.18,4.92,5.18,21.1
```

**Missing Values**: Handled via forward fill (rare)  
**Encoding**: UTF-8  
**Validation**: All required columns present, no complete rows missing

---

### 2. worldbank_raw_indicators.csv
**Source**: World Bank Open Data API  
**Frequency**: Annual (interpolated to monthly in processing)  
**Coverage**: 2000 - 2024  
**Total Rows**: 25

**Columns**:

| Column | Code | Description | Units |
|--------|------|-------------|-------|
| year | N/A | Year of observation | YYYY |
| NY.GDP.MKTP.CD | NY.GDP.MKTP.CD | GDP (current US$) | Billions |
| NY.GDP.PCAP.CD | NY.GDP.PCAP.CD | GDP per Capita (current US$) | US$ |

**Format**:
```csv
year,NY.GDP.MKTP.CD,NY.GDP.PCAP.CD
2000,10318000000000,36789
2001,10581000000000,37135
```

**Missing Values**: Linear interpolation to monthly (happens during alignment)  
**Encoding**: UTF-8

---

### 3. nber_recession_dates.csv
**Source**: National Bureau of Economic Research (NBER)  
**Format**: Official recession start and end dates  
**Rows**: 2 recession periods in data coverage (2001, 2007-09)

**Columns**:

| Column | Type | Description |
|--------|------|-------------|
| start_date | Date (YYYY-MM-DD) | First month of recession |
| end_date | Date (YYYY-MM-DD) | Last month of recession |
| recession_name | String | Name of recession |

**Format**:
```csv
start_date,end_date,recession_name
2001-03-01,2001-11-30,2001 Recession
2007-12-01,2009-06-30,Great Recession
```

**Notes**:
- NBER officially dates recessions as peaks and troughs in economic activity
- These are the ground truth labels for our model
- All months from start_date to end_date (inclusive) labeled as recession (1)

---

## Processed Data Files (`data/processed/`)

### 1. aligned_economic_indicators_monthly.csv
**Generated By**: `src/data_loader.py`  
**Purpose**: Aligned, merged economic data with recession labels  
**Rows**: 300 (January 2000 - December 2024)  
**Columns**: 15 (date + recession_label + 13 indicators)

**Sample**:
```csv
date,recession_label,UNRATE,PAYEMS,CIVPART,INDPRO,HOUST,CPIAUCSL,CPILFESL,UMCSENT,ICSA,DGS10,DGS2,DFF,VIXCLS,GDP,GDPPC
2000-01-01,0,4.0,130500,67.30,85.2,1569,172.00,109.7,112.0,357000,6.15,4.89,5.16,20.5,10.318e12,36789
2001-03-01,1,4.7,131200,67.20,84.5,1400,177.50,110.2,93.5,410000,5.89,3.45,3.50,27.3,10.128e12,35600
2001-04-01,1,4.8,131050,67.15,83.8,1380,177.80,110.3,89.3,420000,5.72,3.12,3.25,28.5,10.100e12,35420
```

**Missing Values**: None (filled via forward fill or interpolation)  
**Recession Distribution**: 28 recession months, 272 normal months (9.3% recessions)  
**Data Quality**: All columns validated, no NaN values

---

### 2. features_engineered_monthly.csv
**Generated By**: `src/feature_engineer.py`  
**Purpose**: Engineered features for machine learning models  
**Rows**: 290 (first 10 rows dropped due to lagging requirements)  
**Columns**: 58 (date + recession_label + 56 features)

**Features by Category**:

#### Yield Curve (6 features)
- `yield_spread`: 10Y - 2Y rate
- `curve_inverted`: Binary (spread < 0)
- `yield_spread_change`: MoM change
- `yield_spread_momentum`: 3M MA of changes
- `yield_spread_vs_avg`: Deviation from historical average
- `yield_spread_contracting`: Binary (change < 0)

#### Growth Rates (13 features)
- `unemployment_change_yoy`, `_qoq`, `_mom`
- `employment_growth_yoy`, `_qoq`, `_mom`
- `industrial_production_growth_yoy`, `_qoq`
- `housing_starts_growth_yoy`, `_qoq`
- `cpi_inflation_yoy`, `_qoq`
- `core_inflation_yoy`

#### Momentum (9 features)
- `unemployment_momentum_3m`, `_6m`
- `employment_momentum_3m`, `_6m`
- `industrial_momentum_3m`, `_6m`
- `sentiment_momentum_3m`, `_6m`
- `participation_momentum_3m`

#### Volatility (7 features)
- `unemployment_volatility_6m`, `_12m`
- `employment_volatility_6m`, `_12m`
- `cpi_volatility_6m`
- `vix_level`, `vix_momentum`
- `vix_high`: Binary (VIX > 20)

#### Spreads (4 features)
- `credit_spread_proxy`: 10Y Treasury - Federal Funds
- `credit_spread_widening`: Binary
- `credit_spread_momentum`: 3M MA
- `term_spread_change_3m`: 3M change in curve

#### Sentiment (8 features)
- `sentiment_change_yoy`, `_qoq`, `_mom`
- `sentiment_declining`: Binary
- `jobless_claims_level`: Normalized
- `jobless_claims_change_yoy`, `_mom`
- `jobless_claims_rising`: Binary

#### Ratios (7 features)
- `participation_unemployment_ratio`
- `participation_change_yoy`
- `export_import_ratio`
- `trade_balance_change`, `_pct_change`
- `gdp_per_capita_change_yoy`
- `gdp_growth_yoy`

#### Composite (2 features)
- `recession_risk_score`: Sum of 7 signals (0-7 scale)
- `recession_risk_high`: Binary (score >= 4)

**Sample**:
```csv
date,recession_label,yield_spread,curve_inverted,unemployment_change_yoy,...,recession_risk_high
2000-01-01,0,-2.26,0,-0.15,...,0
2000-02-01,0,-2.24,0,-0.12,...,0
```

**Missing Values**: None  
**Scaling**: Features NOT scaled (tree models handle raw scales, LogReg with balanced class weights is robust)

---

## Data Transformations

### 1. World Bank Annual → Monthly Interpolation
```python
# Annual GDP converted to monthly via linear interpolation
wb_df['date'] = pd.to_datetime(wb_df['year'].astype(str) + '-01-01')
wb_df = wb_df.set_index('date').asfreq('MS').interpolate()
```

**Impact**: GDP values smoothly transition across months (realistic for economic measures)

### 2. Recession Label Creation
```python
# For each NBER recession date range:
for start, end in nber_dates:
    mask = (df['date'] >= start) & (df['date'] <= end)
    df.loc[mask, 'recession_label'] = 1
```

**Result**: Binary 0/1 labels aligned to NBER official dates

### 3. Lagged Feature Creation
```python
# Example: 12-month % change
df['unemployment_change_yoy'] = df['UNRATE'].pct_change(12)
```

**Impact**: First 12 rows have NaN (dropped), leaving 290 observations

---

## Class Imbalance

**Training Data**: 290 observations
- Recessions: 28 (9.6%)
- Normal: 262 (90.4%)
- Imbalance Ratio: 9.4:1

**Handled By**:
- LogReg: `class_weight='balanced'`
- RandomForest: `class_weight='balanced'`
- XGBoost: `scale_pos_weight=9.4`
- LSTM: SMOTE oversampling

---

## Quality Checks

All data validated before use:

```python
✓ Shape consistency (X = 290 × 56, y = 290 × 1)
✓ Date range (Jan 2000 - Dec 2024)
✓ No NaN values
✓ No infinite values
✓ Recession distribution (28 vs 262)
✓ Feature correlation (max r < 0.95)
✓ Encoding (UTF-8, no special characters)
```

---

## Data Download Instructions

### FRED Data
1. Visit https://fred.stlouisfed.org/
2. Search for each indicator code (UNRATE, PAYEMS, etc.)
3. Click "Download" → CSV format
4. Save to `data/raw/fred_raw_indicators.csv`

### World Bank Data
1. Visit https://data.worldbank.org/
2. Search for "GDP" and "GDP per capita"
3. Download as CSV for year range 2000-2024
4. Save to `data/raw/worldbank_raw_indicators.csv`

### NBER Recession Dates
1. Visit https://www.nber.org/research/business-cycle-dating
2. Copy recession dates into CSV format
3. Save to `data/raw/nber_recession_dates.csv`

---

## File Versioning

| File | Version | Date | Notes |
|------|---------|------|-------|
| fred_raw_indicators.csv | 1.0 | Dec 2024 | Initial download |
| worldbank_raw_indicators.csv | 1.0 | Dec 2024 | Initial download |
| nber_recession_dates.csv | 1.0 | Dec 2024 | NBER official |
| aligned_economic_indicators_monthly.csv | 1.0 | Dec 2024 | Generated Phase 1 |
| features_engineered_monthly.csv | 1.0 | Dec 2024 | Generated Phase 1 |